#### 概念与术语  
【信息】（香农1948）任何可以减少不确定性的事物均为信息。  
【信息系统】（GB 17859）  
【信息资产】  
【威胁】【威胁主体】  
【安全机制】  
【脆弱性】  
【风险评估】  【风险】  
【定性/定量风险评估】  
【机密性】信息不被未授权获取的性质。  
【完整性】信息不被未授权更改的性质。
【数据完整性】  【系统完整性】  【可用性】  【真实性】  【认证/身份鉴别】  【accountability（可追溯性）】  【审计】  
【攻击面】  【攻击树】  
【Bayes定理】  【完善保密性】  【信息熵】  【无条件安全性】  【计算安全性】  【密码学】  【明文】  【密文】  【加密算法】  
【可证明安全】  
【可忽略量】  
【压倒性概率】  
【计算不可区分】  
【问题】  
【判定问题】  
【P问题】  
【NP问题】  
【归约】  
【多项式变换】  
【数字签名】为保护消息产生者对消息的非否认性（即不可抵赖发出消息的行为）而使用私有的密钥或算法对消息进行完整性保护（生成签名串），该完整性保护的签名串其他人无法在多项式时间产生，且通常该完整性保护可以被其他人在多项式时间进行验证。  
【匿名性】同一主体在不同信息交换过程中所用身份的互相不可关联性。  
【形式化方法】在计算机科学领域特别是软件与硬件工程领域，对系统进行的基于数学的定义、开发、验证。是理论计算机科学的应用，包括逻辑演算、形式语言、自动机、离散事件动态系统、程序语义等。  
【区块链】把所有的交易信息（账目），组织成为一个不可篡改的链表，所形成的自带对账功能的数字记账技术。
【访问控制】在主体和客体及资源之间的信息流动进行安全相关的控制。信息的读写流动称之为【访问】，发起访问的主动实体称之为【主体】，被访问的实体称之为【客体】  
【访问控制策略】  
【强制访问控制】  
【自主访问控制】  
【缓冲区溢出】指程序运行时，边界检查不严格的缓冲区被用户输入数据污染所导致的安全问题。溢出数据可通过覆盖返回地址、临时变量、指针等对程序控制流进行劫持，完成恶意行为。  
【软件安全缺陷】即安全漏洞，是软件在设计、实现、配置、运行时的安全弱点，可导致软件因非预期操作产生机密性、数据或系统完整性、可用性等安全属性的破坏。

《图灵完备》：In computability theory, a system of data-manipulation rules (such as a computer's instruction set, a programming language, or a cellular automaton) is said to be Turing complete or computationally universal if it can be used to simulate any Turing machine. λ验算是图灵完备的。图灵不完备的诸如正则语言、下推自动机、context-free grammars。最小的图灵完备语言如one instruction set computer (OISC)，或称（ultimate reduced instruction set computer，URISC），如：Subtract and branch if negative，Subtract and branch if less than or equal to zero。    

#### 简答  
1.信息系统通常由哪些部分组成？答：信息系统通常由以下几部分组成：设备及环境、网络和通信设施、系统及应用软件、数据、信息系统的管理体系和对信息系统进行管理和使用的人员。  
2.对信息系统进行安全分级主要依据什么？答：信息系统承载的使命、信息系统包含的价值、信息系统被破坏后造成的后果，在衡量其价值和后果时，不仅要考虑直接的价值和损失，还要考虑间接的价值和损失。  
3.信息系统的安全管理体系由哪些部分组成？答：主要包括信息安全行政管理和信息安全技术管理两部分，前者包括信息安全策略及管理制度、信息安全机构及人员，后者包括信息系统安全建设和信息系统安全运维。  
4.简述GDPR.答：GDPR=General Data Protection Regulation，即欧盟法规《通用数据保护条例》。法规是对关于个人数据保护和隐私保护的规范，适用于在欧洲开展业务的所有企业，要求这些企业处理个人数据的业务流程必须符合其对个人隐私和个人数据安全性保护的规定。法案于2018年5月开始强制实施，违反此规定的企业将面临公司全球收益4%或两千万欧元（取高者）的罚款。此法案对个人数据及个人隐私的保护起到了积极作用。  
5.简述STRIDE威胁建模。答：  Spoofing、Tampering、Repudiation、Elevation of Privilege、DoS、Info Disclosure  
6.简述PDCA.答：  
7.Dolev-Yao威胁模型中，认为敌手能够做什么，不能够做什么？答：  
8.chmod u+s filename之后，filename文件的权限属性发生了什么变化？答：  
9.简述ruid和euid的区别。答：  
10.setuid位有什么用处？答：  
11.简述访问监测器（Reference Monitor）的NEAT原则。答：  
12.【必考，3分】给出一段关于CPU漏洞的描述，说明这段描述有什么错误。答：  
13.完善保密性有什么特点决定其不具有实用性？证明该特点。  
>答：如Pr[x0]=0,则∀y，Pr[x0|y]=Pr[x0]=0,x0可去除。同理Pr[y0]=0可去除  
  由Bayes：∀y，Pr[x|y]=Pr[x] ⇒ ∀y，Pr[y|x]=Pr[y]  
  给定x：∀y，Pr[y|x]=Pr[y]＞0(可被加成所有密文，每个需要1个Key) ⇒ 需要大于|Y|个密钥 ⇒ |K|≥|C|  
  任意密码体系：|C|≥|P|。因此|K|≥|C|≥|P|。◼  
因此“完善保密性”的方案并不实用。  

14.给出基于密码的数据完整性保护机制的描述。  
>答：设m为任意信息，ke为编码密钥，kv为相应的验证密码。对m的数据完整性保护如下：  
篡改检测码的生成：  MDC←f（ke，m）  
验证：  g（kv，m，MDC）=True，概率为1 如果MDC=f（ke，m）；g（kv，m，MDC）=False，压倒性概率  如果MDC≠f（ke，m）。  
其中，f和g都是有效的密码变换；MDC=Manipulation Detection Code；如果f/q是概率算法，那么概率空间还可能包含一个随机输入空间。  

15.基于公私钥的数字签名为什么可以保证非否认性？
>数字签名本质上是通过私钥对消息进行完整性保护，由于其他人获得私钥或不使用私钥产生有意义的签名是计算上不可行的，所以保证了非否认性。

16.简述BTC中的PoW机制和它的用处。
>答：BTC产生一个区块即记账时，记账者须通过调整区块中的nonce值，使得该区块的Hash值的前n位都是0。其计算次数平均为2的n次方。记账者通过这种方式来争夺记账权。由于包含虚假记录的区块会被其他记账者舍弃，而产生区块又要消耗大量的成本，导致记账者更愿意诚实地产生区块。

17.给出一张图，标出Linux操作系统中的Stack和Heap的位置。答：  
18.如何防范缓冲区溢出？  
>答：1.使用安全形式的printf(); 不使用printf(buffer)  
2.Review loop bounds for off-by-one errors  
3.避免不安全C函数(e.g. strcpy(), strcat(), sprintf(), gets(), scanf())；使用安全函数 (e.g. strncpy(), strncat(), snprintf())  
4.插入边界检查代码；  
5.避免使用不安全编程语言；  
6.代码审计  

19.简述防范栈溢出的StackGuard的canary机制。  
>答：StackGuard 在帧指针和返回地址之间插入一个标记值（canary），溢出覆盖返回地址时会同时覆盖到canary，返回前会检查canary，如canary发生改变则停止程序执行。  

20.简述防范栈溢出DEP机制和ASLR机制。  

21.简述前后断言法。

22.简述污点追踪。

23.简述符号执行。

#### 填空  
1.软件脆弱性产生的top原因是：【不良的编程习惯】。  
2.INTEL通过控制寄存器【 CR0    】提供保护模式。  
3.操作系统的保护模式同实模式的根本区别是【进程内存受保护与否】。  
4.kerckhoffs原则是【          】。  
5.用（P,C,K,E,D）表示密码系统的三个空间和加解密算法，那么：  
> ∀k∈K，∃【（ek∈E，dk∈D）】∀x∈P【（dk（ek（x））=x）】  

6.RSA加密算法的信息熵H(P|C,Ek)=【  0   】  
7.已知定理“条件熵链式法则”为：H（X,Y）=H(Y)+H(X|Y)。其贝叶斯表述为：H（Y|X）=【  H（Y)+H(X|Y)-H（X） 】  
8.BTC所使用的树形Hash数据结构称之为【Merkle】树。  
9.如果能把所有的交易信息（账目），组织成为一个不可篡改的链表，就形成了自带对账功能的数字记账技术：【区块链】  
10.一个访问控制矩阵，如果按列存储，那么就是【ACL】；而按行存储，就是【Capabilities】  
11.【抽象语法树AST】对PL语法结构进行抽象，作为程序的【中间表示】，可用于程序优化、分析及转换等。
#### 选择  
1.软件的脆弱性可分为三类：1.交互的解析有缺陷被误用、2.资源未保护好被滥用、3.安全机制有缺陷被突破；下面属于1的有（  ），2的有（  ），3的有（  ）。
> 命令注入  XSS  溢出  不安全算法  缺盐  

2.ring和虚拟内存都是基于隔离的安全机制，其中ring是（）和（）之间的隔离，虚拟内存是（）和（）之间的隔离。  
> A OS 应用 应用 应用 B OS 应用 应用 OS C 应用 OS OS 应用 D 应用 应用 应用 OS  

3.Reference Monitor与OS Kernel的关系是：（）  
> A RM包含Kernel B Kernel包含RM C RM=Kernel D RM ∩ Kernel=φ  

4.HASH函数的主要用途：（）  
> A 消息摘要/消息指纹 B 用作数字签名（可证明安全的）C 密文正确性验证 D 实用的伪随机函数  

5.以下哪一条不是Hash函数的性质：（）
> A混合变换（对任意输入，与均匀分布二进制串计算不可区分） B 抗碰撞 C 抗原像攻击 D 实用有效性（h的计算时间复杂度是低阶多项式的，最好是线性）

6.BTC的51%算力攻击者能够：（）  
>A Reverse transactions that he sends while he’s in control  
B Prevent some or all transactions from gaining any confirmations  
C Prevent some or all other generators from getting any generations  
D Double spend Bitcoins  

7.BTC的51%算力攻击者不能够：（）  
>A Reverse other people’s transactions
B Prevent transactions from being sent at all (they’ll show as 0/unconfirmed)
C Change the number of coins generated per block
D Create coins out of thin air
E Send coins that never belonged to him


#### 判断对错  
1.使用对称技术实现的篡改检测码MDC常称之为消息鉴别码MAC。√  
2.使用对称技术实现的消息鉴别码MAC常称之为篡改检测码MDC。×  
3.在密码学里面，随机预言机RO对任何输入都回传一个真正均匀随机的输出，对相同的输入每次都会回传相同输出。RO并不存在，将来也难以出现，因为其违反了香农熵的基本原理。√  
4.BTC具有天然的匿名性。×  
5.通常栈计算机的指令长度短于寄存器计算机。√  
6.与寄存器计算机相比，栈计算机更适合于实现抽象计算机模型。√  
7.抽象语法树（AST）通常是编译器无关的，而具体语法树（CST）是编译器相关的。AST通常用来生成IR。√  
8.网络安全中有一些任务需要对大量的样本，进行分类、聚类、回归（预测）、异常检测、关联规则分析等工作。机器学习方法很适用于这项工作。√  
9.网络安全中有一些任务需要对代码进行分析，获取其复杂的业务逻辑，是否存在安全漏洞，机器学习方法很适用于这项工作。×  
10.OS管理的虚拟内存空间中，内核空间与用户空间谁在低地址处取决于数据的大小端模式。×  
11.如数据采取大端模式，则内核空间在低地址处，否则在高地址处。×  
12.如果程序员编写程序的时候使用了栈数据结构的多少，会影响该程序发生栈缓冲区溢出的概率。×  
13.CPU的体系结构对栈溢出的发生具有一定的影响。√  
14.BTC的智能合约语言是图灵完备的。×  
15.Clark-Wilson是一个确保商业数据完整性的访问控制策略模型,由计算机科学家David D. Clark和会计师Davicl R.Wilson提出的。√  
16.通过缓冲区溢出导致程序崩溃的先决条件是free() 函数未检查fd/bk指针。×  
17.通过缓冲区溢出实现代码注入的先决条件是栈地址已知，栈可执行。√  
18.通过缓冲区溢出导致程序崩溃的先决条件是未受保护的栈，通过覆盖关键信息可使程序崩溃。√  
19.通过缓冲区溢出实现Arc注入的先决条件是free() 函数未检查fd/bk指针。
20.防止缓冲区溢出应使用安全C函数如strcpy(), strcat(), sprintf(), gets(), scanf()。×  
21.StackGuard 在帧指针和返回地址之间插入一个标记值（canary），返回前会检查canary，如果canary值不变的话，则抛出异常。×  
22.使用MAC=h(k||m)做消息鉴别是不安全的，应当使用h(k||m||k)。×  
23.使用MAC=h(k||m)做消息鉴别是通常的做法，更为谨慎的做法是使用h(k||m||k)。√  
24.保护模式同实模式的根本区别是管理员用户受保护与否。×  
25.XSS是Web相关常见的脆弱性之一。√  
26.

#### 计算  
1. 信息熵公式，给定信源的概率分布计算其信息熵  
2. 已知一个监测器，能发出8种不同的信号（x1-x8），已知前四种发生的概率是1/1024,后四种发生的概率是255/1024；请给出一种编码方式，使得在通信时，码长的数学期望值低于2.6比特。  

#### 分析  
1. 给一个加密变换，求C的概率分布，求Y|C的条件概率分布，分析说明其是否具有完善保密性。求H(P)、H(K)、H（C）。  
>例：          a(1//4)     b(3/4)  
>   K1(1/2)      1           2  
>   K2(1/4)      2           3  
>   K3(1/4)      3           4  
2. 给一段不安全的C代码，指出问题，并予以修改。  
>△1  void main() {  
char buf[1024];  
gets(buf);  
}  
△2  strcpy(dst, src);  
△3  sprintf(dst, “%s”, src);  
△4  void getUserInfo(char *username, struct _USER_INFO_2 info){  
WCHAR unicodeUser[UNLEN+1];  
MultiByteToWideChar(CP_ACP, 0, username, -1, unicodeUser, sizeof(unicodeUser));  
}  

3. 用BAN逻辑分析一段协议是否实现了某个安全功能。  
4. 以下这段程序有什么安全缺陷？如何进行利用？如何进行预防？  
> if (!access("/tmp/X", W_OK)) //access系统调用检查了真实 UID / GID 是否拥有访问文件的权限，有的话返回 0。
{ f = open("/tmp/X", O_WRITE); write_to_file(f);  } //因为是set-uid root，所以防止用户越权写。
else  fprintf(stderr, "Permission denied\n");    
(注：/tmp属性为777，程序执行过程缓慢，利用的时候不可以修改代码)  

5.给出一段协议，指出其存在的主要安全问题和其他问题。  
>例1：简单协议  
>例2：Woo-Lam协议  

6.根据以下代码，判断：假设程序执行前A、B、C的密级分别为低、中、高，根据基于BLP的信息流控制模型进行分析，程序执行完成后X、Y、Z的密级应当是什么？  

7.以海大教务处选课系统、学工在线系统、医院的医疗信息系统为例，分别说明三个系统在机密性、完整性、可用性方面的保护等级的高低及原因。  
  
8.代码demo.c经编译后，反汇编得到的汇编代码如下，请问编译器使用了什么安全机制，其原理是什么？  
(gdb) disas main  
Dump of assembler code for function main: 
0x08048394 <main+0>:    lea     0x4(%esp),%ecx  
0x08048398 <main+4>:    and     $0xfffffff0,%esp  
0x0804839b <main+7>:    pushl   0xfffffffc(%ecx)  
0x0804839e <main+10>:   push    %ebp  
0x0804839f <main+11>:   mov     %esp,%ebp  
0x080483a1 <main+13>:   push    %ecx  
0x080483a2 <main+14>:   sub     $0x54,%esp  
0x080483a5 <main+17>:   mov     %gs:0x14,%eax     ;   
0x080483ab <main+23>:   mov     %eax,0xfffffff8(%ebp)     ;   
0x080483ae <main+26>:   xor     %eax,%eax     ; eax清零  
0x080483b0 <main+28>:   movl    $0x1,0xffffffb4(%ebp)  
0x080483b7 <main+35>:   movb    $0x61,0xffffffb8(%ebp)  
0x080483bb <main+39>:   mov     $0x0,%eax  
0x080483c0 <main+44>:   mov     0xfffffff8(%ebp),%edx     ;   
0x080483c3 <main+47>:   xor     %gs:0x14,%edx     ;   
0x080483ca <main+54>:   je      0x80483d1 <main+61>     ;   
0x080483cc <main+56>:   call    0x80482fc <__stack_chk_fail@plt>     ;   
0x080483d1 <main+61>:   add     $0x54,%esp  
0x080483d4 <main+64>:   pop     %ecx  
0x080483d5 <main+65>:   pop     %ebp  
0x080483d6 <main+66>:   lea     0xfffffffc(%ecx),%esp  
0x080483d9 <main+69>:   ret     
End of assembler dump.  

附：demo.c  
int main() {  
    int i;  
    char buffer[64];  
    i = 1;  
    buffer[0] = 'a';  
    return 0;  
}  

9.解释以下栈计算机指令的完成的功能。………………  

#### 证明  
1.通过规约的方式，证明如果汉密尔顿回路问题能够有多项式时间复杂度的算法，那么“限制度的生成树问题”就一定有多项式时间复杂度的算法。  

#### 设计  
1.设计一段栈计算机指令，完成以下任务：y=x\*x+(a-b)  

2.给定场景，设计模糊测试的方案。  

#### 其他样题  
1.1900年，数学家（大卫·希尔伯特）提出了23个数学问题，其中第10问题，（丢番图）方程有解的可判定性问题，在1936年被（图灵）证明是不可判定的。
在这一证明过程中提出了著名的（图灵机）模型。  
2.斯蒂芬·库克因其提出的Cook定理奠定了NP完全理论的基础，获得1982年图灵奖。他的这项工作受到了他导师（王浩）所做机器定理证明中的谓词演算可满足性问题的启发，提出了布尔可满足性问题是NP完备的证明即Cook定理。  
3.用于BTC共识的（PoW工作量证明）思想最早由（Cynthia Dwork）和（Moni Naor）于1993年的学术论文提出。  
2.进行风险评估时，主要考虑安全事件发生的（可能性）和（影响程度）  
3.将风险划分成级别的风险评估方法为（定性）风险评估  
4.给出货币价值的风险评估方法为（定量）风险评估  
    
    
#### 第一次课堂报告各小组提供的小题(编号代表提供的小组序号)      
【02】BGP和OSPF在路由协议范围中，分别是什么协议的缩写？   
BGP：边界网关协议      
OSPF：开放最短路径优先协议    
             
【03】由密歇根大学Jon Oberheide等人在The CloudAV? Architecture: N-Version Antivirus in the     
Network Cloud中提出的基于云计算的病毒查杀模型中， “N-Version Antivirus”指的是（）    
A.应用N版本杀毒软件检测         B.应用一组异构检测引擎检测       
C.按提交队列顺序循环查杀N次     C.应用不定方式鉴别算法检测      
         
【06】基于数据挖掘的入侵检测系统主要由数据采集模块，数据预处理模块，以及（D）等部分组成。    
a.数据分类模块  b.规则匹配模块  c.规则库  d.决策模块         
A. b,c,d  B. a,c,d   C. a,b,c  D. a,b,c,d          
      
【07】下列说法中正确的是:(C)    
A.CS97方案是在1998年提出的。    
B.关联性是CS97签名方案的安全性要求之一。     
C.CS97签名方案以离散对数和RSA算法为基础。     
D.CS97签名方案的签名长度依赖于群成员个数。     
    
【11】下面crytbb加密数据不可能用什么方式?（C）    
A 完全同态加密 B 对称加密   C md5  D 都不可以     
    
【12】双线性对在密码中的正面应用与谁有重要关系 (B)     
A. shamir    B. dan?boneh  C. hellman   D. waters     
      
【13】第一次的题目：Lucky13攻击是在TLS/DTLS协议在（A）模式加密下的攻击。     
A.CBC    B.EBC    C.CFB     D.OFB     
     
       
### 第二次课堂报告各小组提供的小题(编号代表提供的小组序号)      
【01】rabin OT哪一年提出的？     
    
【05】对格以及格密码的描述中，错误的是（D）    
A.格是高维空间中的点集。    
B.格可以有多个格基。    
C.格密码可以抵抗量子计算攻击。    
D.格密码LWE加密过程相对传统加密算法复杂      
      
【06】盲签名的性质有（C）        
a.不可伪造性 b.不可抵赖性 c.盲性 d.不可跟踪性            
(A).a,b,c   (B).b,c,d   (C).a,b,c,d   (D).a,c,d     
     
【07】RSA的安全性是否基于质数相乘得到的大数难以分解？     
答案:是     
       
【08】下列有关差分隐私的表述正确的是(C):     
A. ε越大，差分隐私越能保护隐私，但是数据的可用性也越差。     
B. 指数机制适合保护数值型的数据。     
C. 攻击者利用差分攻击的前提是需要有足够的背景知识。     
D. 差分隐私项目RAPPOR是由Apple实现并且维护的。     
       
【11】公平掷币协议是谁提出的？(B)     
A：Adleman   B: Blum   C: Shamir     D:Diffie           
      
【12】是谁提出了ibe(基于身份的加密)？      
A.Shamir     B.Franklin     C.Boneh     D.Waters     
                 
      
【13】门罗币的设计过程中采用了下面哪一项技术（B）     
A.盲签名 B. 环签名 C.群签名     
     
【02】(3,5)的门限方案     
 设 m = 3，n = 5，p = 19，K = 11        
解: 随机选取A1=7、A2=2，构造多项式 f(x)=(7x2 +2x +11) mod 19       
将秘密分割为5份:         
k1 = f(1) = (7*12+2*1+11) mod 19= 1      
k2 = f(2) = (7*22+2*2+11) mod 19= 5      
k3 = f(3) = (7*32+2*3+11) mod 19= 4     
k4 = f(4) = (7*42+2*4+11) mod 19= 17         
k5 = f(5) = (7*52+2*5+11) mod 19= 6          
          
重构f(x)             
给定k2=5、k3=4、k5=6，重构多项式f(x):       
5*(x-3)(x-5)/(2-3)(2-5)=5*13(x-3)(x-5)=65(x-3)(x-5)      
4*(x-2)(x-5)/(3-2)(3-5)=4*9(x-2)(x-5)=36(x-2)(x-5)       
6*(x-2)(x-3)/(5-2)(5-3)=6*16(x-2)(x-3)=96(x-2)(x-3)       
f(x)=[65(x-3)(x-5)+36(x-2)(x-5)+96(x-2)(x-3)]mod19         
 =(26x2-188x+296)mod19              
 =7x2+2x+11       
恢复K=f(0)=11       
          
             
